<style>
  textarea {
    outline: none;
  resize: none;
  width: 400;
  height: 550px;     
  border-radius: 4px;
  border: 1px solid #cccccc;
  padding: 5px;
}
input[type='submit'] {
    width: 100;
    background-color: #4CAF50;
    color: white;
    padding: 3px 5px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
input[type='button'] {
  width: 100;
  background-color: #4CAF50;
  color: white;
  padding: 3px 5px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}
table {
  border-collapse: collapse;
  width: 100%;
}
th, td {
  text-align: left;
  padding: 8px;
}
tr:nth-child(even){background-color: #E9F2C4}
th {
  background-color: #4CAF50;
  color: #E9F2C4;
}
input[type=text], select {
    width: 100;
    padding: 8px 20px;
    margin: 8px 0;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
body {
    border-radius: 5px;
    background-color: #E9F2C4;
    padding: 10px;
    text-align: center;
    font-family: Arial;
    color: rgb(49, 47, 47);
    margin: 0;
  }
</style>

<html><body><center>
  <input type="button" onclick=next_step() value="Next Step" id="ns">
  <table bgcolor="#E9F2C4">
    
  <col width="400">
  <col width="600">
    <tr>
      <th>Visuals</th><th>Code</th>
    </tr>
    <tr>
      <td align="left" VALIGN="TOP" ><div id="workspace"></div></td>
      <td><pre><div id="factarea" style="overflow: scroll;height: 500px;">{{code}}</div></pre></td>
    </tr> 
  </table>
  <table id="updates" style="display:none;"></table>
  <textarea id="ta"  style="display:none;"></textarea>

</center></body></html>

<script src="static\datastructures.js"></script>







<script>//initializing code , starting indexes , flow
  var line=0;
  var curr_line=0;//1 based idx
  var starting_index = [0];//0 based indx
  var code= document.getElementById('factarea').innerHTML;
  var Unaltered_code=code;

  for (i=0;i<code.length;i++){
    if (code[i]=='\n'){
      starting_index.push(i+1);//strating index of every line in the code
    }
  }
  var lineincode = []
  var total_lines = 0
  {% for i in line_seq %}
    total_lines+=1;
    lineincode.push({{i}})// what is sequence of flow for the code
  {% endfor %}

</script>


<script>// for getting data into tables from backend
  //style="display:none;"
  var count=0
  
  {% for i in out %}
    count+=1;
    var num=count.toString(10);
    var rows='<tr><td id='+"name_"+num+'><td id='+"size_"+num+'><td id='+"elem_"+num+'><td id='+"canvas_"+num+'>';
    
    document.getElementById("updates").innerHTML+=rows;
    document.getElementById('name_'+num).innerHTML="\"{{ i.arr_name }}\"";
    document.getElementById('size_'+num).innerHTML={{ i.arr_size }};
    document.getElementById('canvas_'+num).innerHTML= 'canvas_orig_'+"\"{{ i.arr_name }}\"";

    var list=[]
    {% for data in i.arr_elem %}
      list.push({{data}})
    {% endfor %}
    document.getElementById('elem_'+num).innerHTML=list;
  {% endfor %}
</script>




<script>//making canvases
  var dist={{ len_arr }};
  var str="";

  {% for i in arrays %}
    str+="<div style=\"overflow: scroll;\"><canvas id="+"canvas_orig_"+"\"{{i}}\""+" width=\"750\" height=\"60\" ></canvas></div>";
  {% endfor %}
  document.getElementById('workspace').innerHTML=str;

</script>

<script>//function for showing ith update

  function show_step(i){
    console.log(i);
      var name=document.getElementById("name_"+i).innerHTML;
      var size=document.getElementById("size_"+i).innerHTML;
      var elem=document.getElementById("elem_"+i).innerHTML;
      var canvas=document.getElementById("canvas_"+i).innerHTML;
  
      var arr= new array(size,0,0,canvas);
  
      var index=0;
      for (j=0;j<size;j++){
        nextelem="";
        while(index<elem.length && elem[index]!=','){nextelem+=elem[index];index+=1}
        index+=1;
        arr[j].elem=nextelem;
        arr[j].show();
      }
  }
</script>

<script>// for highlighting and dehighlighting  
  function highlight(i){
    dehighlight();

    index=starting_index[i];
    next_idx=code.length
    
    if(i+1<starting_index.length){ 
      next_idx=starting_index[i+1];}

    if(index==0)return;
    code=code.substring(0,index)+"<span style=\"background-color:#F8EF5F\">"+code.substring(index,next_idx-1)+"</span>"+code.substring(next_idx-1,code.length);
    
    document.getElementById('factarea').innerHTML=code;
  }
  
  function dehighlight(){
    code=Unaltered_code;
    document.getElementById('factarea').innerHTML=code;
  }
  var flag_lines = []
  var valid_lines = 1

  {% for i in flag_lines %}
    flag_lines.push({{i}})// what is sequence of flow for the code
  {% endfor %}
</script>



<script>// getting next step

  function next_step(){
    if(line<total_lines){
      line+=1;
      curr_line=lineincode[line-1];//0 based index
      highlight( curr_line-1 );

      if(valid_lines<=count && flag_lines[curr_line-1] != '0' && Unaltered_code[starting_index[curr_line-1]]!='/'){
        show_step(valid_lines);
        valid_lines+=1;
      }
    }
    else{
      document.getElementById("ns").value="Reached EOF";
      dehighlight();
    }
  }
</script>
